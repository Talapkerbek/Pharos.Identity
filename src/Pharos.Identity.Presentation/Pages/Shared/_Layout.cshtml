@using Microsoft.AspNetCore.Hosting
@using Microsoft.AspNetCore.Mvc.ViewEngines
@inject IWebHostEnvironment Environment
@inject ICompositeViewEngine Engine
<!DOCTYPE html>
<html class="w-100 h-100">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Pharos</title>

    <environment include="Development">
        <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.css" />
        <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    </environment>
    <environment exclude="Development">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css"
              integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous"
              asp-fallback-href="~/lib/bootstrap/dist/css/bootstrap.min.css"
              asp-fallback-test-class="sr-only" asp-fallback-test-property="position" asp-fallback-test-value="absolute" />
        <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    </environment>

    <link rel="stylesheet" href="~/css/authPages.css" />
    
</head>
<body class="h-100 w-100 mb-0">

@{
    var path = ViewContext.HttpContext.Request.Path.Value ?? "";
}

@if (!path.StartsWith("/Identity/Account/Login", StringComparison.OrdinalIgnoreCase))
{
    <header>
        <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm border-bottom mb-4">
            <div style="display: flex; width: 100%; margin-left: 20px; margin-right: 20px; justify-content: space-between">
                <!-- Логотип / бренд -->
                <a class="navbar-brand fw-bold text-primary" href="~/Identity/Account/Manage">Pharos Account Management</a>

                <!-- Кнопка для мобильного меню -->
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent"
                        aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Навигация и профиль -->
                <div class="collapse navbar-collapse flex-lg-row-reverse" id="navbarContent">
                    <ul class="navbar-nav ms-auto align-items-center">
                        @* Здесь можно добавить ссылки, если нужно *@
                        <li class="nav-item">
                            @{
                                var result = Engine.FindView(ViewContext, "_LoginPartial", isMainPage: false);
                            }
                            @if (result.Success)
                            {
                                await Html.RenderPartialAsync("_LoginPartial");
                            }
                            else
                            {
                                <span class="text-danger">Login partial not found</span>
                            }
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
}


<partial name="_CookieConsentPartial" optional/>
<main class="h-100 w-100 overflow-hidden">
    @RenderBody()
</main>


<environment include="Development">
    <script src="~/lib/jquery/dist/jquery.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
</environment>
<environment exclude="Development">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"
            asp-fallback-src="~/Identity/lib/jquery/dist/jquery.min.js"
            asp-fallback-test="window.jQuery"
            crossorigin="anonymous"
            integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2">
        </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"
            asp-fallback-src="~/Identity/lib/bootstrap/dist/js/bootstrap.bundle.min.js"
            asp-fallback-test="window.jQuery && window.jQuery.fn && window.jQuery.fn.modal"
            crossorigin="anonymous"
            integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj">
        </script>
    <script src="~/js/site.js" asp-append-version="true"></script>
</environment>

<script src="~/lib/jquery-validation/dist/jquery.validate.js"></script>
<script src="~/lib/jquery-validation-unobtrusive/dist/jquery.validate.unobtrusive.js"></script>

@await RenderSectionAsync("Scripts", required: false)
</body>
</html>
